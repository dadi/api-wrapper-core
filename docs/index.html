<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{#ifCond title '!=' "Documentation"}}{{ pageTitle }}{{else}}DADI platform developer docs{{/ifCond}}</title>
  <meta name="description" content="{{ description }}">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" type="text/css" href="http://stage.dadi.tech/assets/css/main.min.css?v=3">
  <link rel="stylesheet" type="text/css" href="/type.css">
  <link rel="icon" type="image/png" href="http://stage.dadi.tech/assets/img/favicon.png">
</head>
<body class="docs">
<div class="top" style="padding-bottom:70px">
  <div class="top__bg pattern" style="background-color: #333;" data-colors="#333333,#2d2d2d,#272727,#222222,#1c1c1c,#161616,#111111,#0b0b0b,#050505,#000000"></div>

  <div class="container">
    <header class="grid bs-grid">
      <div class="col w-1-4 bs-w-1-2">
        <h1><a href="https://dadi.tech/" class="inline-block"><img src="http://stage.dadi.tech/assets/img/dadi-light.svg" width="150" alt="DADI"></a></h1>
      </div>
      <div class="col w-1-4 bs-w-1-2">
        <ul class="normal nav marg__right--x2">
          <li><a href="https://dadi.tech/platform/">Platform</a></li>
          <li><a href="http://docs.dadi.tech/" class="active">Documentation</a></li>
          <li><a href="https://dadi.tech/success-stories/" >Success stories</a></li>
          <li><a href="https://dadi.tech/latest/" >Latest</a></li>
        </ul>
      </div>
      <div class="col w-1-4 bs-w-1-1 promos">
        <p class="fwb small">Looking for a hosted technology solution?</p>
        <a href="https://dadi.tech/on-demand/" class="btn btn--fill btn--red">On demand</a>
      </div>
      <div class="col w-1-4 bs-w-1-1 promos">
        <p class="fwb small">Need help integrating or customising our platform?</p>
        <a href="https://dadi.tech/solutions/" class="btn btn--fill btn--green">Solutions</a>
      </div>
    </header>
    <div class="larger hdr">Unit Test Documentation: @dadi/api-wrapper-core</div>
  </div>
</div>

  <main>
    <div class="container normal">
    <section class="suite">
      <h1>Filters</h1>
      <dl>
        <dt>should pass argument given in `fromEndpoint` to the wrapper</dt>
        <dd><pre><code>wrapper.fromEndpoint('testEndpoint')
wrapper.endpoint.should.eql('testEndpoint')
done()</code></pre></dd>
        <dt>should pass argument given in `goToPage` to the wrapper</dt>
        <dd><pre><code>wrapper.goToPage(1)
wrapper.page.should.eql(1)
done()</code></pre></dd>
        <dt>should pass argument given in `in` to the wrapper</dt>
        <dd><pre><code>wrapper.in('collectionOne')
wrapper.collection.should.eql('collectionOne')
done()</code></pre></dd>
        <dt>should pass argument given in `limitTo` to the wrapper</dt>
        <dd><pre><code>wrapper.limitTo(10)
wrapper.limit.should.eql(10)
done()</code></pre></dd>
        <dt>should pass arguments given in `sortBy` to the wrapper</dt>
        <dd><pre><code>wrapper.sortBy('name', 'desc')
wrapper.sort.should.eql({'name':-1})
done()</code></pre></dd>
        <dt>should pass argument given in `useDatabase` to the wrapper</dt>
        <dd><pre><code>wrapper.useDatabase('test')
wrapper.customDatabase.should.eql('test')
done()</code></pre></dd>
        <dt>should pass argument given in `useFields` to the wrapper</dt>
        <dd><pre><code>wrapper.useFields(['name', '_id'])
wrapper.fields.should.eql(JSON.stringify({ name: 1, _id: 1}))
done()</code></pre></dd>
        <dt>should pass argument given in `useVersion` to the wrapper</dt>
        <dd><pre><code>wrapper.useVersion('2.0')
wrapper.customVersion.should.eql('2.0')
done()</code></pre></dd>
        <dt>should set the saved query to a Mongo query expression</dt>
        <dd><pre><code>wrapper.where({})
wrapper.query.should.eql({})
done()</code></pre></dd>
        <dt>should add a /^value/i regex expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldBeginsWith(field, value)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$regex&quot;: &quot;^John Doe&quot; } }'))
done()</code></pre></dd>
        <dt>should add a /value/i regex expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldContains(field, value)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$regex&quot;: &quot;John Doe&quot; } }'))
done()</code></pre></dd>
        <dt>should add a negated /value/i regex expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldDoesNotContain(field, value)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$not&quot;: &quot;/John Doe/i&quot; } }'))
done()</code></pre></dd>
        <dt>should add a {$exists: true} expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldExists(field)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$ne&quot;: null } }'))
done()</code></pre></dd>
        <dt>should add a {$exists: false} expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldDoesNotExist(field)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$eq&quot;: null } }'))
done()</code></pre></dd>
        <dt>should add a /value$/i regex expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldEndsWith(field, value)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$regex&quot;: &quot;John Doe$&quot; } }'))
done()</code></pre></dd>
        <dt>should add an exact match expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsEqualTo(field, value)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: &quot;John Doe&quot; }'))
done()</code></pre></dd>
        <dt>should add a negated exact match expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsNotEqualTo(field, value)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$not&quot; : &quot;/^John Doe$/i&quot; } }'))
done()</code></pre></dd>
        <dt>should add a negated exact match expression to the saved query when given a Number</dt>
        <dd><pre><code>wrapper.whereFieldIsNotEqualTo(field, 34)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$ne&quot; : 34 } }'))
done()</code></pre></dd>
        <dt>should add a $in expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsOneOf(field, matches)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$in&quot; : [&quot;John&quot;, &quot;Jane&quot;] } }'))
done()</code></pre></dd>
        <dt>should add a $nin expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsNotOneOf(field, matches)
wrapper.query.should.eql(JSON.parse('{ &quot;name&quot;: { &quot;$nin&quot; : [&quot;John&quot;, &quot;Jane&quot;] } }'))
done()</code></pre></dd>
        <dt>should add a $lt expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsLessThan('age', 50)
wrapper.query.should.eql(JSON.parse('{ &quot;age&quot;: { &quot;$lt&quot; : 50 } }'))
done()</code></pre></dd>
        <dt>should add a $lte expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsLessThanOrEqualTo('age', 50)
wrapper.query.should.eql(JSON.parse('{ &quot;age&quot;: { &quot;$lte&quot; : 50 } }'))
done()</code></pre></dd>
        <dt>should add a $gt expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsGreaterThan('age', 50)
wrapper.query.should.eql(JSON.parse('{ &quot;age&quot;: { &quot;$gt&quot; : 50 } }'))
done()</code></pre></dd>
        <dt>should add a $gte expression to the saved query</dt>
        <dd><pre><code>wrapper.whereFieldIsGreaterThanOrEqualTo('age', 50)
wrapper.query.should.eql(JSON.parse('{ &quot;age&quot;: { &quot;$gte&quot; : 50 } }'))
done()</code></pre></dd>
        <dt>should pass argument given in `withComposition` to the wrapper</dt>
        <dd><pre><code>wrapper.withComposition(true)
wrapper.compose.should.eql(true)
done()</code></pre></dd>
        <dt>should pass argument given in `includeHistory` to the wrapper</dt>
        <dd><pre><code>wrapper.includeHistory(true)
wrapper.history.should.eql(true)
done()</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>Helpers</h1>
      <dl>
        <section class="suite">
          <h1>_reset</h1>
          <dl>
            <dt>should reset internal properties</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test')
wrapper.customVersion.should.eql('2.0')
wrapper._reset()
should.not.exist(wrapper.customVersion)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>_stripReservedProperties</h1>
          <dl>
            <dt>should remove internal properties</dt>
            <dd><pre><code>var document = {
  apiVersion: '1.0',
  createdBy: 'test',
  v: 1,
  name: 'John'
}
document = wrapper._stripReservedProperties(document)
should.not.exist(document.v)
should.not.exist(document.apiVersion)
should.not.exist(document.createdBy)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>Build URL</h1>
          <dl>
            <dt>should use values from the options object</dt>
            <dd><pre><code>var wrapperUrl = wrapper._buildURL()
var parsedUrl = url.parse(wrapperUrl)
var parsedOptionsUri = url.parse(options.uri)
parsedUrl.hostname.should.eql(parsedOptionsUri.hostname)
parsedUrl.port.should.eql(options.port.toString())
done()</code></pre></dd>
            <dt>should use version and database if specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test').in('collectionOne')
var wrapperUrl = wrapper._buildURL()
wrapperUrl.should.eql('http://0.0.0.0:8000/2.0/test/collectionOne')
done()</code></pre></dd>
            <dt>should build /api url if no collection or endpoint specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test')
var wrapperUrl = wrapper._buildURL()
wrapperUrl.should.eql('http://0.0.0.0:8000/api')
done()</code></pre></dd>
            <dt>should accept database and version options when initialising</dt>
            <dd><pre><code>options.version = '2.4'
options.database = 'test2'
wrapper = new apiWrapper(options)
wrapper.in('collectionOne')._buildURL().should.eql('http://0.0.0.0:8000/2.4/test2/collectionOne')
done()</code></pre></dd>
            <dt>should use version and endpoint if specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test').fromEndpoint('endpointOne')
var wrapperUrl = wrapper._buildURL()
wrapperUrl.should.eql('http://0.0.0.0:8000/2.0/endpointOne')
done()</code></pre></dd>
            <dt>should build /status url if option specified</dt>
            <dd><pre><code>var wrapperUrl = wrapper._buildURL({status:true})
wrapperUrl.should.eql('http://0.0.0.0:8000/api/status')
done()</code></pre></dd>
            <dt>should build /collections url if option specified</dt>
            <dd><pre><code>var wrapperUrl = wrapper._buildURL({collections:true})
wrapperUrl.should.eql('http://0.0.0.0:8000/api/collections')
done()</code></pre></dd>
            <dt>should build /count url if extractMetadata option specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test').in('collectionOne')
var wrapperResult = wrapper.find({extractMetadata:true})
wrapperResult.uri.href.should.eql('http://0.0.0.0:8000/2.0/test/collectionOne/count')
done()</code></pre></dd>
            <dt>should build /config url if option specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test').in('collectionOne')
var wrapperUrl = wrapper._buildURL({config:true})
wrapperUrl.should.eql('http://0.0.0.0:8000/2.0/test/collectionOne/config')
done()</code></pre></dd>
            <dt>should build /stats url if option specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test').in('collectionOne')
var wrapperUrl = wrapper._buildURL({stats:true})
wrapperUrl.should.eql('http://0.0.0.0:8000/2.0/test/collectionOne/stats')
done()</code></pre></dd>
            <dt>should build id url if option specified</dt>
            <dd><pre><code>wrapper.useVersion('2.0').useDatabase('test').in('collectionOne')
var wrapperUrl = wrapper._buildURL({id:123456})
wrapperUrl.should.eql('http://0.0.0.0:8000/2.0/test/collectionOne/123456')
done()</code></pre></dd>
            <dt>should append query to the querystring if specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }) }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John')
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append page to the querystring if specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), page: 33 }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').goToPage(33)
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append limit to the querystring if specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), count: 10 }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').limitTo(10)
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should not append limit to the querystring if a non-digit is specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }) }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').limitTo('name')
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append sort to the querystring if specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), sort: JSON.stringify({ name: 1 }) }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').sortBy('name', 'asc')
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append fields to the querystring if specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), fields: JSON.stringify({ name: 1 }) }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').useFields(['name'])
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append compose value to the querystring if specified and `true`</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), compose: true }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').withComposition(true)
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append compose value to the querystring if specified and `false`</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), compose: false }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').withComposition(false)
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
            <dt>should append includeHistory value to the querystring if specified</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), includeHistory: true }
var expectedQuerystring  = '?' + decodeURIComponent(querystring.stringify(query))
wrapper.useVersion('1.0').useDatabase('test').in('collectionOne').whereFieldIsEqualTo('name', 'John').includeHistory(true)
var wrapperUrl = wrapper._buildURL({useParams: true})
wrapperUrl.should.eql('http://0.0.0.0:8000/1.0/test/collectionOne' + expectedQuerystring)
done()</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Initialisation</h1>
      <dl>
        <dt>should be requirable</dt>
        <dd><pre><code>apiWrapper.should.be.Function
done()</code></pre></dd>
        <dt>should accept options and return an instance</dt>
        <dd><pre><code>var wrapper = new apiWrapper(options)
wrapper.options.should.eql(options)
done()</code></pre></dd>
        <dt>should use defaults if options aren't provided</dt>
        <dd><pre><code>delete options.port
    var wrapper = new apiWrapper(options)
    wrapper.options.should.eql(options)
    done()</code></pre></dd>
        <section class="suite">
          <h1>Helpers</h1>
          <dl>
            <dt>should attach `_addToQuery` to the wrapper</dt>
            <dd><pre><code>wrapper._addToQuery.should.be.Function
done()</code></pre></dd>
            <dt>should attach `_buildURL` to the wrapper</dt>
            <dd><pre><code>wrapper._buildURL.should.be.Function
done()</code></pre></dd>
            <dt>should attach `_createRequestObject` to the wrapper</dt>
            <dd><pre><code>wrapper._createRequestObject.should.be.Function
done()</code></pre></dd>
            <dt>should attach `_log` to the wrapper</dt>
            <dd><pre><code>wrapper._log.should.be.Function
done()</code></pre></dd>
            <dt>should attach `_reset` to the wrapper</dt>
            <dd><pre><code>wrapper._reset.should.be.Function
done()</code></pre></dd>
            <dt>should attach `_stripReservedProperties` to the wrapper</dt>
            <dd><pre><code>wrapper._stripReservedProperties.should.be.Function
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>Filters</h1>
          <dl>
            <dt>should attach `fromEndpoint` to the wrapper</dt>
            <dd><pre><code>wrapper.fromEndpoint.should.be.Function
done()</code></pre></dd>
            <dt>should attach `goToPage` to the wrapper</dt>
            <dd><pre><code>wrapper.goToPage.should.be.Function
done()</code></pre></dd>
            <dt>should attach `in` to the wrapper</dt>
            <dd><pre><code>wrapper.in.should.be.Function
done()</code></pre></dd>
            <dt>should attach `limitTo` to the wrapper</dt>
            <dd><pre><code>wrapper.limitTo.should.be.Function
done()</code></pre></dd>
            <dt>should attach `sortBy` to the wrapper</dt>
            <dd><pre><code>wrapper.sortBy.should.be.Function
done()</code></pre></dd>
            <dt>should attach `useDatabase` to the wrapper</dt>
            <dd><pre><code>wrapper.useDatabase.should.be.Function
done()</code></pre></dd>
            <dt>should attach `useFields` to the wrapper</dt>
            <dd><pre><code>wrapper.useFields.should.be.Function
done()</code></pre></dd>
            <dt>should attach `useVersion` to the wrapper</dt>
            <dd><pre><code>wrapper.useVersion.should.be.Function
done()</code></pre></dd>
            <dt>should attach `where` to the wrapper</dt>
            <dd><pre><code>wrapper.where.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldBeginsWith` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldBeginsWith.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldContains` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldContains.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldDoesNotContain` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldDoesNotContain.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldExists` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldExists.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldDoesNotExist` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldDoesNotExist.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldEndsWith` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldEndsWith.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsEqualTo` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsEqualTo.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsNotEqualTo` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsNotEqualTo.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsOneOf` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsOneOf.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsNotOneOf` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsNotOneOf.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsLessThan` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsLessThan.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsGreaterThan` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsGreaterThan.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsLessThanOrEqualTo` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsLessThanOrEqualTo.should.be.Function
done()</code></pre></dd>
            <dt>should attach `whereFieldIsGreaterThanOrEqualTo` to the wrapper</dt>
            <dd><pre><code>wrapper.whereFieldIsGreaterThanOrEqualTo.should.be.Function
done()</code></pre></dd>
            <dt>should attach `withComposition` to the wrapper</dt>
            <dd><pre><code>wrapper.withComposition.should.be.Function
done()</code></pre></dd>
            <dt>should attach `includeHistory` to the wrapper</dt>
            <dd><pre><code>wrapper.includeHistory.should.be.Function
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>Terminators</h1>
          <dl>
            <dt>should attach `find` to the wrapper</dt>
            <dd><pre><code>wrapper.find.should.be.Function
done()</code></pre></dd>
            <dt>should attach `create` to the wrapper</dt>
            <dd><pre><code>wrapper.create.should.be.Function
done()</code></pre></dd>
            <dt>should attach `update` to the wrapper</dt>
            <dd><pre><code>wrapper.update.should.be.Function
done()</code></pre></dd>
            <dt>should attach `delete` to the wrapper</dt>
            <dd><pre><code>wrapper.delete.should.be.Function
done()</code></pre></dd>
            <dt>should attach `getConfig` to the wrapper</dt>
            <dd><pre><code>wrapper.getConfig.should.be.Function
done()</code></pre></dd>
            <dt>should attach `setConfig` to the wrapper</dt>
            <dd><pre><code>wrapper.setConfig.should.be.Function
done()</code></pre></dd>
            <dt>should attach `getStats` to the wrapper</dt>
            <dd><pre><code>wrapper.getStats.should.be.Function
done()</code></pre></dd>
            <dt>should attach `getStatus` to the wrapper</dt>
            <dd><pre><code>wrapper.getStatus.should.be.Function
done()</code></pre></dd>
            <dt>should attach `getSignedUrl` to the wrapper</dt>
            <dd><pre><code>wrapper.getSignedUrl.should.be.Function
done()</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
    <section class="suite">
      <h1>Terminators</h1>
      <dl>
        <section class="suite">
          <h1>create</h1>
          <dl>
            <dt>should create the request object for creating the documents</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }), page: 33 }
var expectedQuerystring  = '?' + querystring.stringify(query)
wrapper.useVersion('1.0')
       .useDatabase('test')
       .in('collectionOne')
       .whereFieldIsEqualTo('name', 'John')
       .goToPage(33)
var wrapperUrl = wrapper._buildURL({useParams: false})
// Stripping `_id` out of `documents`
var documentsCopy = [
  {name: documents[0].name},
  {name: documents[1].name}
]
var requestObject = wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .create(documents)
requestObject.method.should.eql('POST')
JSON.stringify(requestObject.body).should.eql(JSON.stringify(documentsCopy))
requestObject.uri.href.should.eql(wrapperUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>delete</h1>
          <dl>
            <dt>should throw an error if no query is specified</dt>
            <dd><pre><code>should.throws(function () {
  return wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .delete()
})</code></pre></dd>
            <dt>should create the request object for deleting each document from the query</dt>
            <dd><pre><code>var query = { query: { name: 'John Doe' } }
var expectedQuerystring  = '?' + querystring.stringify(query)
var requestObject = wrapper.useVersion('1.0')
                           .useDatabase('test')
                           .in('collectionOne')
                           .whereFieldIsEqualTo(field, value)
                           .delete()
var expectedUrl = wrapper._buildURL({useParams: false})
requestObject.method.should.eql('DELETE')
JSON.stringify(requestObject.body).should.eql(JSON.stringify(query))
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>update</h1>
          <dl>
            <dt>should throw an error if no query is specified</dt>
            <dd><pre><code>should.throws(function () {
  return wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .update()
})</code></pre></dd>
            <dt>should create the request object for updating each document from the query</dt>
            <dd><pre><code>var query = { query: { name: 'John Doe' } }
var expectedQuerystring  = '?' + querystring.stringify(query)
var requestObject = wrapper.useVersion('1.0')
                           .useDatabase('test')
                           .in('collectionOne')
                           .whereFieldIsEqualTo(field, value)
                           .update({ name: 'Jane Doe' })
var expectedUrl = wrapper._buildURL({useParams: false})
requestObject.method.should.eql('PUT')
requestObject.body.query.should.eql(query.query)
requestObject.body.update.should.eql({ name: 'Jane Doe' })
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>find</h1>
          <dl>
            <dt>should create the request object for finding documents affected by the query</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }) }
var requestObject = wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .whereFieldIsEqualTo('name', 'John')
  .find({extractResults: true})
var expectedUrl = wrapper._buildURL({useParams: true})
requestObject.method.should.eql('GET')
should.not.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>getConfig</h1>
          <dl>
            <dt>should create the request object for getting a collection config</dt>
            <dd><pre><code>var requestObject = wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .getConfig()
var expectedUrl = wrapper._buildURL({config: true})
requestObject.method.should.eql('GET')
should.not.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>setConfig</h1>
          <dl>
            <dt>should create the request object for updating the API config</dt>
            <dd><pre><code>var requestObject = wrapper
  .setConfig({
    server: {
      host: '0.0.0.0'
    }
  })
var expectedUrl = wrapper._buildURL({config: true})
requestObject.method.should.eql('POST')
should.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
            <dt>should create the request object for updating a collection's config</dt>
            <dd><pre><code>var requestObject = wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .setConfig({
    fields: {
      field1: {
        type: 'String'
      }
    }
  })
var expectedUrl = wrapper._buildURL({config: true})
requestObject.method.should.eql('POST')
should.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>getStats</h1>
          <dl>
            <dt>should create the request object for getting collection stats</dt>
            <dd><pre><code>var query = { filter: JSON.stringify({ name: 'John' }) }
var requestObject = wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .getStats()
var expectedUrl = wrapper._buildURL({stats: true})
requestObject.method.should.eql('GET')
should.not.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>getStatus</h1>
          <dl>
            <dt>should create the request object for getting the status endpoint</dt>
            <dd><pre><code>var requestObject = wrapper
  .getStatus()
var expectedUrl = wrapper._buildURL({status: true})
requestObject.method.should.eql('POST')
should.not.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>getCollections</h1>
          <dl>
            <dt>should create the request object for getting the collections endpoint</dt>
            <dd><pre><code>var requestObject = wrapper
  .getCollections()
var expectedUrl = wrapper._buildURL({collections: true})
requestObject.method.should.eql('GET')
should.not.exist(requestObject.body)
requestObject.uri.href.should.eql(expectedUrl)
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>getSignedUrl</h1>
          <dl>
            <dt>should create the request object for getting a signed URL</dt>
            <dd><pre><code>var urlParameters = {
  fileName: 'foobar.jpg',
  mimetype: 'image/jpeg'
}
var requestObject = wrapper
  .inMedia('images')
  .getSignedUrl(urlParameters)
var expectedUrl = wrapper._buildURL({signUrl: true})
requestObject.method.should.eql('POST')
requestObject.uri.href.should.eql(expectedUrl)
JSON.stringify(requestObject.body).should.eql(JSON.stringify(urlParameters))
done()</code></pre></dd>
          </dl>
        </section>
        <section class="suite">
          <h1>callback option</h1>
          <dl>
            <dt>should run a callback on the request object before returning, when defined</dt>
            <dd><pre><code>var optionsWithCallback = Object.assign({}, options, {
  callback: function stringifyRequestObject (requestObject) {
    return JSON.stringify(requestObject)
  }
})
var wrapperWithCallback = new apiWrapper(optionsWithCallback)
var query = { filter: JSON.stringify({ name: 'John' }) }
var requestObject = wrapper
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .whereFieldIsEqualTo('name', 'John')
  .find({extractResults: true})
var requestObjectWithCallback = wrapperWithCallback
  .useVersion('1.0')
  .useDatabase('test')
  .in('collectionOne')
  .whereFieldIsEqualTo('name', 'John')
  .find({extractResults: true})
JSON.stringify(requestObject).should.eql(requestObjectWithCallback)
done()</code></pre></dd>
          </dl>
        </section>
      </dl>
    </section>
</div>
</main>

<div class="footer bg--light-grey bdr__top bdr--bdr-grey pad__top--x2 pad__bottom--x2">
<footer class="small container">
<div class="marg__top--x2 pad__top pad__bottom alignc">
  <ul class="list--inline block marg__bottom--x2">
    <li class="fwb">© DADI+ Ltd.</li>
    <li><a href="https://twitter.com/dadi">Follow us on Twitter</a></li>
    <li><a href="https://github.com/dadi">Find us on Github</a></li>
    <li><a href="https://github.com/dadi/api-wrapper-core">View the repo for this site</a></li>
  </ul>
  <img src="https://dadi.tech/assets/img/d.svg" class="marg__right--x2 alignv" width="45">
</div>
</footer>
</div>

<script src="http://stage.dadi.tech/assets/js/pattern.min.js"></script>
<script src="http://stage.dadi.tech/assets/js/main.js?v=2"></script>
</body>
</html>